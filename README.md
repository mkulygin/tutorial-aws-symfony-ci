# tutorial-aws-symfony-ci
$(aws ecr get-login --no-include-email --region eu-west-1)

Stage
docker build -t tutorial-aws-symfony-ci:stg -f Dockerfile.stg .
docker tag tutorial-aws-symfony-ci:stg 254002134964.dkr.ecr.eu-west-1.amazonaws.com/tutorial-aws-symfony-ci:stg
docker push 254002134964.dkr.ecr.eu-west-1.amazonaws.com/tutorial-aws-symfony-ci:stg
docker run -p 80:80 tutorial-aws-symfony-ci:stg

Prod
docker build -t tutorial-aws-symfony-ci:prod .
docker tag tutorial-aws-symfony-ci:prod 254002134964.dkr.ecr.eu-west-1.amazonaws.com/tutorial-aws-symfony-ci:prod
docker push 254002134964.dkr.ecr.eu-west-1.amazonaws.com/tutorial-aws-symfony-ci:prod
docker run -p 80:80 tutorial-aws-symfony-ci:prod


Add role AmazonEC2ContainerRegistryReadOnly to aws-elasticbeanstalk-ec2-role in IAM

Get docker login by:
aws ecr get-login --region eu-west-1 --no-include-email


Add EB_REGION (eu-west-1)  variable to CircleCI
https://circleci.com/gh/mkulygin/tutorial-aws-symfony-ci/edit#env-vars

Check docker login:
docker login -u AWS -p eyJwYXlsb2FkIjoiRFRkS1ZJN3h5N0lmNW5oMDVnZDlKYjlpbXIrZ01OQUVCMUd5ZDJ6N3J0ZUszV2NJM1UwVEJpeWZONTMrZUNiSk00SEJXbTZreVEyT2ZuNHlTQzdZbklKOEkvczJPZDNQS0RRRkJCTmxEcnlvYlZHaUVUV3RoNzNUTlplUUdBUkkxOWh0Z1lNcVFobnhCUW5QYlVtRmFxR1VNcVo1L2dGTjdqRzhuR1UwRWU1dWh2UU1aRDA3d2JlU3o1MzVnZmJzZDlwMGgzaWI2K3krYmFpZXkwNnEvY1lwMFZpOWNkNlZ3YXpiYjE1N1hxcWtPYml5VUR4ZjZwUFFDd0oxSUdOSW1wWTU5SEIvN1JYZGtua2o3cjVaQkNEMy9Hd1JXWW5XSm90Tk96NXFpWXlWZWVZYm85bFhnV3o1WW9BTG9iZEQyWVZwRWRhNGRmSFR5NVlwN1YrZTBpTnl5ODN4VjlCZ2pUNXc1a2sxLzdFbUJjOHdmUlExSjhOZHhrOU1Wa0dxTERNdm5nOG5VSC9PZHFaYVhrVkw5MEcvYXZJZGt4NDdNcUhyRDhrSzBXTW4ranBYTGpuNVRQU0dldlBVWmE0ZytiTWpEUVJ2clFxY1F1NnVJVGc5V0Vkc1ZlQmZYSzZGclJidTRBS1NwYmtRbktJK0xrUGRPdkF4YVd2WndOYlorWWV2ck9CcmVsMzBoQ1lEY0tXZ2F1NG1hSXI4TEpmMnBTcjNHbXBNOXJQVW9POVducm1UcVh0bERzMUk0azYvb1dvek5vL1BIT1Z3V1NnNzZDUUpTdjFpakUvOGRTeTBEelpRaitCVG1NTnlzT2RKS2lhNnFleFlYT3dTMC96V3pkZzZPL0RGSEgra3dBWnlzSXVQWjhsektHUUtnREQwOWtUdlhaY1d4R3hvbnBTejd5bzZmcTc5Z3owMEJ5RHFMTUx6Yi9NMzcvZEtBYm9MSHd4bjhRTkkydWhFVWI3Z2NDaG1HNDBHTTZmSFdCRGxlRWN3TUJWbDd5ai9vMTRLRDBucnd6VUYrVkJWak1WVkwrNWRpMS8wZTN5QThIZHM0OXdpV0RpUi9TbHhjZmZuWThjcVo3K1I5VlJFbDVNNVk4Y3RoTWxFVzIyZjBmc3k2ZThZNHhnMzFSYnhlTWphN2RXaWQwdE8ySUNRcitXNU93UmRCSkVPM2Q0akNubmlER1J5bzNIRnlNMnplRTlFK0h4bWU0S0htVzRINmp0Tm1OK2Fka3RXN0QrM2FQUnRHQldGWnRtQTBacXl2TndvTUFPNEJpRm9KMHh5a05EbG55SDdiMURROUFSRGZHZEFVZWc5QkdTU0t1YXZkSlJxTWlrNks4dHBEOTR2dHJYdlM0WFY4M0REQWh0RytDUDVaSXIxRmpIbXg5QWpmVGJFbjRJMWkwNnhtSUw4dXkyNVp2dmRsZW9KeEcydjNNbzRETWxkUjN1VHNkaS9SQT09IiwiZGF0YWtleSI6IkFRRUJBSGgrZFMrQmxOdTBOeG5Yd293YklMczExNXlqZCtMTkFaaEJMWnN1bk94azNBQUFBSDR3ZkFZSktvWklodmNOQVFjR29HOHdiUUlCQURCb0Jna3Foa2lHOXcwQkJ3RXdIZ1lKWUlaSUFXVURCQUV1TUJFRURKZ0xBdVFpVHNTVDVsUVZ6d0lCRUlBNzR0QXcyQ05CQnV3Z1YvOW5GT1pOSjNpQXVnQmZKcmdZeVZiWlBaUmU1K0RsdGNBdGkrNEQrMVY4YXlSV0RVSFdJUEFpTDZVU0RxTkNqQWs9IiwidmVyc2lvbiI6IjIiLCJ0eXBlIjoiREFUQV9LRVkiLCJleHBpcmF0aW9uIjoxNTgwNjU4MjMxfQ== https://254002134964.dkr.ecr.eu-west-1.amazonaws.com
eval $(aws ecr get-login --region eu-west-1 --no-include-email)